{"version":3,"file":"static/webpack/static/development/pages/dynamic-array.js.04735f3b9dbc1f675a7b.hot-update.js","sources":["webpack:///./middlewares/SubmitButtonMw.tsx"],"sourcesContent":["import * as React from 'react';\nimport _ from 'lodash';\nimport { Form, Button, Alert } from 'antd';\nimport { AntdFormMiddlewareProps } from './share';\nimport { ErrorObject, validate } from './ValidateMw';\n\nexport const SubmitButtonMw: React.ComponentType<AntdFormMiddlewareProps> = (props) => {\n  const {\n    parent,\n    next,\n    formProps: { onSubmit },\n  } = props;\n  if (parent) return next(props);\n  const { extraProps } = props;\n  return (\n    <>\n      {props.next(props)}\n      <Form.Item>\n        <Button onClick={onSubmit} type=\"primary\" {..._.get(extraProps, 'props')}>\n          Submit\n        </Button>\n      </Form.Item>\n    </>\n  );\n};\n\nexport const SubmitButtonWithValidationMw: React.ComponentType<AntdFormMiddlewareProps> = (props) => {\n  const {\n    data,\n    parent,\n    next,\n    formProps: { schema, onSubmit },\n  } = props;\n  const [errors, setErrors] = React.useState<ErrorObject[] | null>(null);\n  const [ajvException, setAjvException] = React.useState<Error | null>(null);\n\n  if (parent) return next(props);\n  const { extraProps } = props;\n\n  const handleClick = () => {\n    try {\n      const errors = validate(schema, data);\n      if (!errors) onSubmit && onSubmit(data);\n      setErrors(errors);\n      ajvException && setAjvException(null);\n    } catch (err) {\n      setAjvException(err);\n    }\n  };\n\n  return (\n    <>\n      {props.next(errors === props.errors ? props : { ...props, errors })}\n      <Form.Item>\n        <Button onClick={handleClick} type=\"primary\" {..._.get(extraProps, 'props')}>\n          Submit\n        </Button>\n      </Form.Item>\n      {ajvException ? <Alert message=\"Ajv exception\" description={ajvException.message} type=\"error\" showIcon /> : null}\n    </>\n  );\n};\n\nexport default SubmitButtonMw;\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AAGA;AAEA;AAAA;AAAA;AAAA;AAMA;AANA;AAQA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAMA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AASA;AAVA;AACA;AAYA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAEA;;;;A","sourceRoot":""}